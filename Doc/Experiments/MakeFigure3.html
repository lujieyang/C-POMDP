<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of MakeFigure3</title>
  <meta name="keywords" content="MakeFigure3">
  <meta name="description" content="Generates Figure 3.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<table width="810" border="0" align="center" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td>
      <img src="../top.png" alt="Institut de Rob&ograve;tica i Inform&agrave;tica Industrial" width="775" height="60" border="0" USEMAP="#logos"/></td>
      <map name="logos">
       <area shape="rect" coords="740,0,775,60" href="http://www.csic.es" target="_blank">
       <area shape="circle" coords="706,29,20" href="http://www.upc.edu" target="_blank">
       <area shape="rect" coords ="0,0,740,60" href="http://www-iri.upc.es" target="_blank">
      </map>
    </td>
  </tr>
  <tr>
    <td>


<a name="_top"></a>
<!-- # Experiments -->
<h1>MakeFigure3
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>Generates Figure 3.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function MakeFigure3(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">   Generates Figure 3.

   Simulates a POMDP on one of the results obtained in the experiment in
   Figure 1. If the results are not pre-computed we compute them on the
   fly (this can be quite time consuming).
   

   The simulation shows the evolution of the belief and the
   executed actions and the obtained reward are printed in the Matlab
   console. 
   At the end we also print the accumulated discounted reward for the
   trial.
   This data can be used to generate a sequence of snapshots as
   those in the figure.

   This is an example of how to use the resulting policy out of a planning
   experiment.

   Parameters
     n: Number of steps of the simulation. If not given 15.

 'n' == simulation steps</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href=".././@Policy/OptimalAction.html" class="code" title="function [a v]=OptimalAction(P,b)">OptimalAction</a>	Returns the optimal action for a given belief.</li><li><a href=".././@Policy/Policy.html" class="code" title="function P=Policy(varargin)">Policy</a>	Policy constructor.</li><li><a href=".././Belief/@DBelief/plot.html" class="code" title="function h=plot(b,varargin)">plot</a>	Plots a discrete belief.</li><li><a href=".././Belief/@DBelief/rand.html" class="code" title="function v=rand(b)">rand</a>	Random state from a discrete belief.</li><li><a href=".././Belief/@GBelief/get.html" class="code" title="function v=get(gb,field)">get</a>	Get for GBeliefs.</li><li><a href=".././Belief/@PBelief/plot.html" class="code" title="function h=plot(pb,varargin)">plot</a>	Displays a particle-based belief.</li><li><a href=".././Belief/@PBelief/rand.html" class="code" title="function v=rand(b)">rand</a>	Random state from a belief.</li><li><a href=".././Lib/@GMixture/get.html" class="code" title="function value=get(gm,field,varargin)">get</a>	Get function for the GMixture object.</li><li><a href=".././Lib/@GMixture/plot.html" class="code" title="function h=plot(gm,varargin)">plot</a>	Plots a Gaussian mixture.</li><li><a href=".././Lib/@GMixture/rand.html" class="code" title="function v=rand(gm,varargin)">rand</a>	Generates random points on a GMixture.</li><li><a href=".././Lib/@GMixture/set.html" class="code" title="function gm=set(gm,field,value)">set</a>	Set method for Gaussian mixtures.</li><li><a href=".././Lib/@Gaussian/get.html" class="code" title="function out=get(g,field)">get</a>	Gaussian object get function.</li><li><a href=".././Lib/@Gaussian/plot.html" class="code" title="function h=plot(g,varargin)">plot</a>	Plots a Gaussian.</li><li><a href=".././Lib/@Gaussian/rand.html" class="code" title="function r=rand(g,varargin)">rand</a>	Generates random ponts on a Gaussian.</li><li><a href=".././Lib/GetData.html" class="code" title="function data=GetData(fname,GenerateData)">GetData</a>	Loads and, if necessary, generates data from experiments.</li><li><a href=".././Lib/TestRep.html" class="code" title="function TestRep(varargin)">TestRep</a>	Executes many times of Perseus on a given problem.</li><li><a href=".././ObsModel/@CS_CO_ObsModel/plot.html" class="code" title="function h=plot(OM)">plot</a>	Plots the CS_CO_ObsModel</li><li><a href=".././POMDP/@CS_CO_CA_POMDP/get.html" class="code" title="function value=get(P,field)">get</a>	Get function for CS_CO_CA_POMDPs.</li><li><a href=".././POMDP/@CS_CO_DA_POMDP/get.html" class="code" title="function value=get(P,field)">get</a>	Get function for CS_CO_DA_POMDPs.</li><li><a href=".././POMDP/@CS_CO_POMDP/get.html" class="code" title="function value=get(P,field)">get</a>	Get function for CS_CO_POMDPs.</li><li><a href=".././POMDP/@CS_DO_CA_POMDP/get.html" class="code" title="function value=get(P,field)">get</a>	Get function for CS_DO_CA_POMDPs.</li><li><a href=".././POMDP/@CS_DO_DA_POMDP/get.html" class="code" title="function value=get(P,field)">get</a>	Get function for CS_DO_DA_POMDPs.</li><li><a href=".././POMDP/@CS_POMDP/get.html" class="code" title="function value=get(P,field)">get</a>	Get function for CS_POMDPs.</li><li><a href=".././POMDP/@DS_CO_CA_POMDP/get.html" class="code" title="function value=get(P,field)">get</a>	Get function for DS_CO_CA_POMDPs.</li><li><a href=".././POMDP/@DS_CO_DA_POMDP/get.html" class="code" title="function value=get(P,field)">get</a>	Get function for DS_CO_DA_POMDPs.</li><li><a href=".././POMDP/@DS_DO_CA_POMDP/get.html" class="code" title="function value=get(P,field)">get</a>	Get function for DS_DO_CA_POMDPs.</li><li><a href=".././POMDP/@DS_DO_DA_POMDP/get.html" class="code" title="function value=get(P,field)">get</a>	Get function for DS_DO_DA_POMDPs.</li><li><a href=".././POMDP/@POMDP/POMDP.html" class="code" title="function P=POMDP(varargin)">POMDP</a>	POMDP constructor.</li><li><a href=".././POMDP/@POMDP/SimulationStep.html" class="code" title="function [s b o r]=SimulationStep(P,b,s,a)">SimulationStep</a>	Executes one step of a POMDP simulation.</li><li><a href=".././POMDP/@POMDP/get.html" class="code" title="function value=get(P,field)">get</a>	Get functio for POMDPs.</li><li><a href=".././POMDP/@POMDP/set.html" class="code" title="function P=set(P,field,value)">set</a>	Set function for PODMP (base type)</li><li><a href=".././RewardModel/@CS_CA_RewardModel/plot.html" class="code" title="function h=plot(RM)">plot</a>	Plots the CS_CA_RewardModel</li><li><a href=".././Space/@CSpace/rand.html" class="code" title="function v=rand(CS)">rand</a>	Random state from a continuous space.</li><li><a href=".././Space/@DSpace/rand.html" class="code" title="function v=rand(DS)">rand</a>	Random state from a discrete space.</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function MakeFigure3(varargin)</a>
0002 <span class="comment">%   Generates Figure 3.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%   Simulates a POMDP on one of the results obtained in the experiment in</span>
0005 <span class="comment">%   Figure 1. If the results are not pre-computed we compute them on the</span>
0006 <span class="comment">%   fly (this can be quite time consuming).</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%   The simulation shows the evolution of the belief and the</span>
0010 <span class="comment">%   executed actions and the obtained reward are printed in the Matlab</span>
0011 <span class="comment">%   console.</span>
0012 <span class="comment">%   At the end we also print the accumulated discounted reward for the</span>
0013 <span class="comment">%   trial.</span>
0014 <span class="comment">%   This data can be used to generate a sequence of snapshots as</span>
0015 <span class="comment">%   those in the figure.</span>
0016 <span class="comment">%</span>
0017 <span class="comment">%   This is an example of how to use the resulting policy out of a planning</span>
0018 <span class="comment">%   experiment.</span>
0019 <span class="comment">%</span>
0020 <span class="comment">%   Parameters</span>
0021 <span class="comment">%     n: Number of steps of the simulation. If not given 15.</span>
0022 <span class="comment">%</span>
0023   <span class="comment">% 'n' == simulation steps</span>
0024   
0025   <span class="keyword">if</span> nargin==0
0026     n=15;
0027   <span class="keyword">else</span>
0028     n=varargin{1};
0029   <span class="keyword">end</span>
0030 
0031   fprintf(<span class="string">'Loading/Generating the simulation results\n'</span>);
0032 
0033   GenData=@()(<a href=".././Lib/TestRep.html" class="code" title="function TestRep(varargin)">TestRep</a>(<span class="string">'Test1'</span>,<span class="string">'Figure2'</span>,1));
0034   Results=<a href=".././Lib/GetData.html" class="code" title="function data=GetData(fname,GenerateData)">GetData</a>(<span class="string">'Results/Test1-Figure2-1.mat'</span>,GenData);
0035   
0036   <span class="comment">% Get the parameters used to generate the results</span>
0037   P=Results.P;
0038   
0039   <span class="comment">% Get the POMDP</span>
0040   <a href=".././POMDP/@POMDP/POMDP.html" class="code" title="function P=POMDP(varargin)">POMDP</a>=Results.POMDP;
0041   
0042   <span class="comment">% Get the las policy of the simulation</span>
0043   <a href=".././@Policy/Policy.html" class="code" title="function P=Policy(varargin)">Policy</a>=Results.V{end};
0044   
0045   <span class="comment">% Get the initial belief from the parmeters</span>
0046   b=P.start;
0047   
0048   <span class="comment">% The hidden state is selecte at random</span>
0049   s=<a href=".././Belief/@DBelief/rand.html" class="code" title="function v=rand(b)">rand</a>(b);
0050   
0051   fprintf(<span class="string">'SIMULATING\n'</span>);
0052   fprintf(<span class="string">'INITIAL STATE %f\n'</span>,s);
0053    
0054   h=clf;
0055   <a href=".././Lib/@GMixture/set.html" class="code" title="function gm=set(gm,field,value)">set</a>(h,<span class="string">'name'</span>,<span class="string">'C-POMDP Figure 3'</span>,<span class="string">'numbertitle'</span>,<span class="string">'off'</span>);
0056   
0057   h=<a href=".././Belief/@DBelief/plot.html" class="code" title="function h=plot(b,varargin)">plot</a>(b); 
0058   xlabel(<span class="string">'s'</span>);
0059   ylabel(<span class="string">'p(s)'</span>)
0060   axis([-20 20 0 1]);
0061   hold on;
0062   rAll=0;
0063   gamma=<a href=".././Belief/@GBelief/get.html" class="code" title="function v=get(gb,field)">get</a>(<a href=".././POMDP/@POMDP/POMDP.html" class="code" title="function P=POMDP(varargin)">POMDP</a>,<span class="string">'gamma'</span>);
0064   g=1;
0065   <span class="keyword">for</span> i=1:n
0066     fprintf(<span class="string">'\nSTEP %u: '</span>,i);
0067     a=<a href=".././@Policy/OptimalAction.html" class="code" title="function [a v]=OptimalAction(P,b)">OptimalAction</a>(<a href=".././@Policy/Policy.html" class="code" title="function P=Policy(varargin)">Policy</a>,b);
0068     fprintf(<span class="string">'  action: %u ('</span>,a);
0069     <span class="keyword">switch</span> a
0070       <span class="keyword">case</span> 1
0071         fprintf(<span class="string">'Move-Left'</span>);
0072       <span class="keyword">case</span> 2
0073         fprintf(<span class="string">'Move-Right'</span>);
0074       <span class="keyword">case</span> 3
0075         fprintf(<span class="string">'Enter-Door'</span>);
0076     <span class="keyword">end</span>
0077     [s b o r]=<a href=".././POMDP/@POMDP/SimulationStep.html" class="code" title="function [s b o r]=SimulationStep(P,b,s,a)">SimulationStep</a>(<a href=".././POMDP/@POMDP/POMDP.html" class="code" title="function P=POMDP(varargin)">POMDP</a>,b,s,a);
0078     rAll=rAll+g*r;
0079     g=g*gamma;
0080     fprintf(<span class="string">')  state:%f  reward: %f   '</span>,s,r);
0081     delete(h);
0082     h=<a href=".././Belief/@DBelief/plot.html" class="code" title="function h=plot(b,varargin)">plot</a>(b);
0083     fprintf(<span class="string">'&lt;press a key&gt;'</span>);
0084     pause;
0085   <span class="keyword">end</span>
0086   hold off
0087   fprintf(<span class="string">'\n\nDiscounted reward: %f\n'</span>,rAll);
0088   
0089   
0090</pre></div>
<br>
<br>

  </table>
 <table width="810" height="35" border="0" align="center" cellpadding="0" background="../espai.png">
  <tr>
    <td>
      <span class="footer" align="center"><center>
        <a href="http://www-iri.upc.es"  target="_blank">Institut de Rob&ograve;tica i Inform&agrave;tica Industrial</a>
      </center></span>
    </td>
  </tr>
</table>

<hr><address>Generated on Wed 05-Aug-2009 15:05:21 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>